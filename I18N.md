# Internationalization (i18n) Scripts

This project includes npm scripts to help onboard new languages and keep existing translations up to date with the English source. The scripts now feature **AI-powered translation and validation** using Amazon Bedrock with Claude 4 Sonnet.

## Available Scripts

### Basic Scripts

#### `npm run i18n:onboard <language-code>`

Creates a new language file with placeholder translations based on the English source.

**Usage:**
```bash
npm run i18n:onboard es        # Spanish
npm run i18n:onboard fr        # French  
npm run i18n:onboard de        # German
npm run i18n:onboard ja        # Japanese
npm run i18n:onboard fr-CA     # French (Canada)
```

**What it does:**
- Creates a new JSON file in `src/locales/` with the specified language code
- Copies the entire structure from English (`en.json`)
- Replaces all translation values with placeholders that indicate what needs to be translated
- Provides clear next steps for completing the translation

**Example output:**
```json
{
  "homepage": {
    "title": "[homepage.title] - TRANSLATE: Accessible App Suite",
    "subtitle": "[homepage.subtitle] - TRANSLATE: A collection of accessible and fun applications"
  }
}
```

#### `npm run i18n:update [language-code]`

Updates existing language files with any missing keys from the English source.

**Usage:**
```bash
npm run i18n:update           # Update all languages
npm run i18n:update es        # Update only Spanish
npm run i18n:update fr        # Update only French
```

**What it does:**
- Compares existing language files with the current English source
- Adds any missing keys with placeholder translations
- Preserves existing translations
- Reports how many keys were added to each language

#### `npm run i18n:list`

Shows the status of all available languages and their translation progress.

**Usage:**
```bash
npm run i18n:list
```

**What it shows:**
- All available language files
- Translation completion status
- Number of keys that need translation
- Available commands

### 🤖 AI-Powered Scripts (NEW)

These scripts use Amazon Bedrock with Claude 4 Sonnet to provide intelligent translation and validation capabilities.

#### `npm run i18n:ai-onboard <language-code> [--skip-ai]`

Creates a new language file with **automatic AI translation** of all content.

**Usage:**
```bash
npm run i18n:ai-onboard es                    # Create Spanish with AI translations
npm run i18n:ai-onboard fr                    # Create French with AI translations
npm run i18n:ai-onboard de --skip-ai          # Create German with placeholders only
```

**What it does:**
- Creates a new JSON file with the specified language code
- **Automatically translates all content** using Claude 4 Sonnet
- Provides context-aware translations appropriate for web UI
- Preserves interpolation variables like `{{variable}}`
- Maintains accessibility terminology accuracy
- Falls back to placeholders if AI translation fails

**Example output:**
```json
{
  "homepage": {
    "title": "Suite de Aplicaciones Accesibles",
    "subtitle": "Una colección de aplicaciones accesibles y divertidas"
  }
}
```

#### `npm run i18n:ai-translate [language-code]`

Translates placeholder content in existing language files using AI.

**Usage:**
```bash
npm run i18n:ai-translate           # Translate placeholders in all languages
npm run i18n:ai-translate es        # Translate placeholders in Spanish only
```

**What it does:**
- Scans language files for placeholder content (contains "TRANSLATE:")
- Automatically translates placeholder content using Claude 4 Sonnet
- Preserves already-translated content
- Provides context from key paths for better translations
- Reports translation progress and results

#### `npm run i18n:ai-validate [language-code]`

Validates translation quality using AI analysis.

**Usage:**
```bash
npm run i18n:ai-validate           # Validate all languages
npm run i18n:ai-validate es        # Validate Spanish only
```

**What it does:**
- Compares translations with original English content
- Evaluates accuracy, fluency, and UI appropriateness
- Checks preservation of interpolation variables
- Validates accessibility terminology usage
- Generates detailed quality scores (0-100)
- Creates a comprehensive validation report
- Provides specific improvement suggestions

**Example validation output:**
```
📊 es Validation Summary:
   Total validated: 134
   ✅ Passed: 128
   ❌ Failed: 6
   📈 Success rate: 95.5%
```

## AWS Bedrock Setup

To use the AI-powered features, you need to configure AWS credentials with access to Amazon Bedrock.

### Prerequisites

1. **AWS Account** with Bedrock access
2. **Model Access**: Request access to Claude 4 Sonnet in AWS Bedrock console
3. **IAM Permissions**: `bedrock:InvokeModel` permission
4. **AWS Credentials** configured

### Configuration Options

#### Option 1: Environment Variables
```bash
export AWS_ACCESS_KEY_ID=your_access_key
export AWS_SECRET_ACCESS_KEY=your_secret_key
export AWS_REGION=us-east-1
```

#### Option 2: AWS Credentials File
Create `~/.aws/credentials`:
```ini
[default]
aws_access_key_id = your_access_key
aws_secret_access_key = your_secret_key
region = us-east-1
```

#### Option 3: IAM Roles
When running on AWS (EC2, Lambda, etc.), use IAM roles with appropriate permissions.

### Required IAM Policy
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "bedrock:InvokeModel"
      ],
      "Resource": [
        "arn:aws:bedrock:*::foundation-model/anthropic.claude-3-5-sonnet-20241022-v2:0"
      ]
    }
  ]
}
```

## Workflow Examples

### AI-Powered Language Onboarding

1. **Create with automatic translation:**
   ```bash
   npm run i18n:ai-onboard es
   ```

2. **Validate AI translations:**
   ```bash
   npm run i18n:ai-validate es
   ```

3. **Check status:**
   ```bash
   npm run i18n:list
   ```

4. **Add to i18n configuration** and test

### Traditional Language Onboarding

1. **Create with placeholders:**
   ```bash
   npm run i18n:onboard es
   ```

2. **Translate with AI:**
   ```bash
   npm run i18n:ai-translate es
   ```

3. **Validate quality:**
   ```bash
   npm run i18n:ai-validate es
   ```

### Maintaining Existing Languages

When English content is updated:

1. **Update all languages:**
   ```bash
   npm run i18n:update
   ```

2. **Translate new placeholders:**
   ```bash
   npm run i18n:ai-translate
   ```

3. **Validate all translations:**
   ```bash
   npm run i18n:ai-validate
   ```

4. **Review validation report** and make manual adjustments if needed

## File Structure

```
src/
├── locales/
│   ├── en.json     # English (source)
│   ├── es.json     # Spanish
│   ├── fr.json     # French
│   └── ...         # Other languages
├── i18n.ts         # i18n configuration
└── scripts/
    ├── bedrock-ai-service.js      # AWS Bedrock integration
    ├── i18n-ai-onboard.js         # AI-powered onboarding
    ├── i18n-ai-translate.js       # AI translation
    ├── i18n-ai-validate.js        # AI validation
    ├── i18n-onboard-language.js   # Basic onboarding
    ├── i18n-update-languages.js   # Update languages
    └── i18n-list-languages.js     # List status
```

## Translation Quality Features

The AI translation system includes several quality assurance features:

- **Context Awareness**: Uses key paths to provide context for better translations
- **Variable Preservation**: Maintains interpolation variables like `{{count}}` exactly
- **UI Optimization**: Ensures translations are appropriate for web interfaces
- **Accessibility Focus**: Properly translates accessibility-related terminology
- **Consistency**: Uses lower temperature settings for consistent results
- **Validation**: Multi-criteria quality assessment with actionable feedback

## Error Handling

The scripts include comprehensive error handling:

- **Credential Validation**: Checks AWS setup before starting
- **Fallback Options**: Provides alternatives when AI is unavailable
- **Partial Failure Recovery**: Continues processing even if individual translations fail
- **Clear Error Messages**: Provides specific guidance for resolution
- **Validation Reports**: Documents issues for manual review

## Notes

- Language codes should follow ISO 639-1 (e.g., `en`, `es`, `fr`) or include region codes (e.g., `fr-CA`, `en-GB`)
- The English file (`en.json`) is considered the source of truth
- AI translations are optimized for web UI and accessibility content
- Always run tests after making i18n changes
- Review AI translations for context-specific accuracy
- The validation report helps identify translations that need manual adjustment