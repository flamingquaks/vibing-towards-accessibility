# Internationalization (i18n) Scripts

This project includes npm scripts to help onboard new languages and keep existing translations up to date with the English source. The scripts now feature **AI-powered translation and validation** using Ollama with local language models.

## Available Scripts

### Basic Scripts

#### `npm run i18n:onboard <language-code>`

Creates a new language file with placeholder translations based on the English source.

**Usage:**
```bash
npm run i18n:onboard es        # Spanish
npm run i18n:onboard fr        # French  
npm run i18n:onboard de        # German
npm run i18n:onboard ja        # Japanese
npm run i18n:onboard fr-CA     # French (Canada)
```

**What it does:**
- Creates a new JSON file in `src/locales/` with the specified language code
- Copies the entire structure from English (`en.json`)
- Replaces all translation values with placeholders that indicate what needs to be translated
- Provides clear next steps for completing the translation

**Example output:**
```json
{
  "homepage": {
    "title": "[homepage.title] - TRANSLATE: Accessible App Suite",
    "subtitle": "[homepage.subtitle] - TRANSLATE: A collection of accessible and fun applications"
  }
}
```

#### `npm run i18n:update [language-code]`

Updates existing language files with any missing keys from the English source.

**Usage:**
```bash
npm run i18n:update           # Update all languages
npm run i18n:update es        # Update only Spanish
npm run i18n:update fr        # Update only French
```

**What it does:**
- Compares existing language files with the current English source
- Adds any missing keys with placeholder translations
- Preserves existing translations
- Reports how many keys were added to each language

#### `npm run i18n:list`

Shows the status of all available languages and their translation progress.

**Usage:**
```bash
npm run i18n:list
```

**What it shows:**
- All available language files
- Translation completion status
- Number of keys that need translation
- Available commands

### ü§ñ AI-Powered Scripts (NEW)

These scripts use Ollama with local language models to provide intelligent translation and validation capabilities.

#### `npm run i18n:ai-onboard <language-code> [--skip-ai]`

Creates a new language file with **automatic AI translation** of all content using **gpt-oss:20b**.

**Usage:**
```bash
npm run i18n:ai-onboard es                    # Create Spanish with AI translations
npm run i18n:ai-onboard fr                    # Create French with AI translations
npm run i18n:ai-onboard de --skip-ai          # Create German with placeholders only
```

**What it does:**
- Creates a new JSON file with the specified language code
- **Automatically translates all content** using gpt-oss:20b model
- Provides context-aware translations appropriate for web UI
- Preserves interpolation variables like `{{variable}}`
- Maintains accessibility terminology accuracy
- Falls back to placeholders if AI translation fails

**Example output:**
```json
{
  "homepage": {
    "title": "Suite de Aplicaciones Accesibles",
    "subtitle": "Una colecci√≥n de aplicaciones accesibles y divertidas"
  }
}
```

#### `npm run i18n:ai-translate [language-code]`

Translates placeholder content in existing language files using AI with **gpt-oss:20b**.

**Usage:**
```bash
npm run i18n:ai-translate           # Translate placeholders in all languages
npm run i18n:ai-translate es        # Translate placeholders in Spanish only
```

**What it does:**
- Scans language files for placeholder content (contains "TRANSLATE:")
- Automatically translates placeholder content using gpt-oss:20b model
- Preserves already-translated content
- Provides context from key paths for better translations
- Reports translation progress and results

#### `npm run i18n:ai-validate [language-code]`

Validates translation quality using AI analysis with **gemma3:4b**.

**Usage:**
```bash
npm run i18n:ai-validate           # Validate all languages
npm run i18n:ai-validate es        # Validate Spanish only
```

**What it does:**
- Compares translations with original English content using gemma3:4b model
- Evaluates accuracy, fluency, and UI appropriateness
- Checks preservation of interpolation variables
- Validates accessibility terminology usage
- Generates detailed quality scores (0-100)
- Creates a comprehensive validation report
- Provides specific improvement suggestions

**Example validation output:**
```
üìä es Validation Summary:
   Total validated: 134
   ‚úÖ Passed: 128
   ‚ùå Failed: 6
   üìà Success rate: 95.5%
```

## Ollama Setup

To use the AI-powered features, you need to have Ollama installed and running with the required models.

### Prerequisites

1. **Ollama Installation**: Install Ollama from [https://ollama.ai](https://ollama.ai)
2. **Required Models**: Pull the necessary models
3. **Ollama Server**: Ensure Ollama is running

### Installation & Setup

#### Step 1: Install Ollama
```bash
# macOS
brew install ollama

# Linux
curl -fsSL https://ollama.ai/install.sh | sh

# Windows - Download from https://ollama.ai/download
```

#### Step 2: Start Ollama Server
```bash
ollama serve
```

#### Step 3: Pull Required Models
```bash
# Translation model (20B parameters for high-quality translations)
ollama pull gpt-oss:20b

# Validation model (4B parameters for efficient validation)
ollama pull gemma3:4b
```

### Configuration Options

#### Default Configuration
- **Host**: `http://localhost:11434` (default Ollama port)
- **Translation Model**: `gpt-oss:20b`
- **Validation Model**: `gemma3:4b`

#### Custom Configuration
Set environment variable for custom Ollama host:
```bash
export OLLAMA_HOST=http://your-ollama-server:11434
```

### Model Information

#### gpt-oss:20b (Translation Model)
- **Size**: ~20 billion parameters
- **Use**: High-quality translations with context awareness
- **Strengths**: Excellent multilingual capabilities, maintains context
- **Disk Space**: ~12GB

#### gemma3:4b (Validation Model)  
- **Size**: ~4 billion parameters
- **Use**: Fast and efficient translation quality assessment
- **Strengths**: Good analytical capabilities, faster inference
- **Disk Space**: ~2.5GB

## Workflow Examples

### AI-Powered Language Onboarding

1. **Start Ollama and ensure models are available:**
   ```bash
   ollama serve
   ollama list  # Check available models
   ```

2. **Create with automatic translation:**
   ```bash
   npm run i18n:ai-onboard es
   ```

3. **Validate AI translations:**
   ```bash
   npm run i18n:ai-validate es
   ```

4. **Check status:**
   ```bash
   npm run i18n:list
   ```

5. **Add to i18n configuration** and test

### Traditional Language Onboarding

1. **Create with placeholders:**
   ```bash
   npm run i18n:onboard es
   ```

2. **Translate with AI:**
   ```bash
   npm run i18n:ai-translate es
   ```

3. **Validate quality:**
   ```bash
   npm run i18n:ai-validate es
   ```

### Maintaining Existing Languages

When English content is updated:

1. **Update all languages:**
   ```bash
   npm run i18n:update
   ```

2. **Translate new placeholders:**
   ```bash
   npm run i18n:ai-translate
   ```

3. **Validate all translations:**
   ```bash
   npm run i18n:ai-validate
   ```

4. **Review validation report** and make manual adjustments if needed

## File Structure

```
src/
‚îú‚îÄ‚îÄ locales/
‚îÇ   ‚îú‚îÄ‚îÄ en.json     # English (source)
‚îÇ   ‚îú‚îÄ‚îÄ es.json     # Spanish
‚îÇ   ‚îú‚îÄ‚îÄ fr.json     # French
‚îÇ   ‚îî‚îÄ‚îÄ ...         # Other languages
‚îú‚îÄ‚îÄ i18n.ts         # i18n configuration
‚îî‚îÄ‚îÄ scripts/
    ‚îú‚îÄ‚îÄ ollama-ai-service.js           # Ollama integration
    ‚îú‚îÄ‚îÄ i18n-ai-onboard.js             # AI-powered onboarding
    ‚îú‚îÄ‚îÄ i18n-ai-translate.js           # AI translation
    ‚îú‚îÄ‚îÄ i18n-ai-validate.js            # AI validation
    ‚îú‚îÄ‚îÄ i18n-onboard-language.js       # Basic onboarding
    ‚îú‚îÄ‚îÄ i18n-update-languages.js       # Update languages
    ‚îî‚îÄ‚îÄ i18n-list-languages.js         # List status
```

## Translation Quality Features

The AI translation system includes several quality assurance features:

- **Context Awareness**: Uses key paths to provide context for better translations
- **Variable Preservation**: Maintains interpolation variables like `{{count}}` exactly
- **UI Optimization**: Ensures translations are appropriate for web interfaces
- **Accessibility Focus**: Properly translates accessibility-related terminology
- **Consistency**: Uses optimized temperature settings for consistent results
- **Local Processing**: All translation happens locally for privacy and speed
- **Validation**: Multi-criteria quality assessment with actionable feedback

## Error Handling

The scripts include comprehensive error handling:

- **Connection Validation**: Checks Ollama connectivity before starting
- **Model Availability**: Verifies required models are pulled and available
- **Fallback Options**: Provides alternatives when AI is unavailable
- **Partial Failure Recovery**: Continues processing even if individual translations fail
- **Clear Error Messages**: Provides specific guidance for resolution
- **Validation Reports**: Documents issues for manual review

## Performance & Privacy

### Performance Benefits
- **Local Processing**: No network latency for API calls
- **Concurrent Processing**: Can run multiple translation tasks
- **No Rate Limits**: Process as fast as your hardware allows
- **Offline Capable**: Works without internet connection

### Privacy Benefits
- **Local Data**: All translation data stays on your machine
- **No Cloud Dependencies**: No external API keys or accounts needed
- **Secure**: Translation content never leaves your environment

## Notes

- Language codes should follow ISO 639-1 (e.g., `en`, `es`, `fr`) or include region codes (e.g., `fr-CA`, `en-GB`)
- The English file (`en.json`) is considered the source of truth
- AI translations are optimized for web UI and accessibility content
- Always run tests after making i18n changes
- Review AI translations for context-specific accuracy
- The validation report helps identify translations that need manual adjustment
- Ensure sufficient disk space for models (~15GB total)
- Consider hardware requirements for optimal performance (8GB+ RAM recommended)